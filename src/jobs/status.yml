description: Sens status message to Teams Workflow via Web Hook
executor: default

parameters:
  teams_url:
    type: string
    description: URL of the Teams Workflow
  failed_message:
    types: string
    default: "ðŸ”´ Failed"
    description: "Message text if tests are failed"
  passed_message:
    types: string
    default: "ðŸŸ¢ Successful"
    description: "Message text if tests are passed"
steps:
  - run:
      name: Set failed status
      command: |
      echo 'export COLOR_STATUS="attention"' >> $BASH_ENV
      echo 'export MSG_STATUS="<< parameters.failed_message >>"' >> $BASH_ENV
       when: on_fail
  -run:
      name: Set Success status
      command: |
        echo 'export COLOR_STATUS="good"' >> $BASH_ENV
        echo 'export MSG_STATUS="<< parameters.passed_message >>"' >> $BASH_ENV
      when: on_success
  - send_msg:
      teams_url: << teams_url >>
      message: ${MSG_STATUS}
      color: ${COLOR_STATUS}

