description: Sens status message to Teams Workflow via Web Hook
executor: default

parameters:
  teams_url:
    type: string
    description: URL of the Teams Workflow
    default: "https://prod-185.westus.logic.azure.com:443/workflows/b11e01c116ef4db0952f80068bbd5909/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=7N_pCDKQhibDDiJqD_J4V8IsW51oNapo0thgwpUxncc"
  failed_message:
    type: string
    default: "ðŸ”´ Failed"
    description: "Message text if tests are failed"
  passed_message:
    type: string
    default: "ðŸŸ¢ Successful"
    description: "Message text if tests are passed"
steps:
  - run:
      name: Set failed status
      command: |
        echo 'export MSG_STATUS="failed"' >> $BASH_ENV
      when: on_fail
      descrioption: setup message and color for case if tests failed.
  - run:
      name: Set Success status
      command: |
        echo 'export MSG_STATUS="success"' >> $BASH_ENV
      when: on_success
      descrioption: setup message and color for case if tests passed.

  - send_msg:
      teams_url: << parameters.teams_url >>
      message: ${MSG_STATUS}
      color: "good"
#test
